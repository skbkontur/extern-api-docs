.. _Accounts: https://developer.kontur.ru/doc/extern/method?type=get&path=%2Fv1
.. _`GET All`: https://developer.kontur.ru/doc/extern/method?type=get&path=%2Fv1
.. _`POST Account`: https://developer.kontur.ru/doc/extern/method?type=post&path=%2Fv1
.. _`GET Account`: https://developer.kontur.ru/doc/extern/method?type=get&path=%2Fv1%2F%7BaccountId%7D
.. _`GET Users`: https://developer.kontur.ru/doc/extern/method?type=get&path=%2Fv1%2F%7BaccountId%7D%2Fusers 
.. _`DELETE Account`: https://developer.kontur.ru/doc/extern/method?type=delete&path=%2Fv1%2F%7BaccountId%7D

Методы для работы с учетными записями
=====================================

Подробная спецификация методов представлена в swagger в разделе Accounts_.

Список доступных методов:

* `Получение списка всех доступных учетных записей`_
* `Создание новой учетной записи`_
* `Получение учетной записи по идентификатору`_
* `Получение списка пользователей учетной записи`_
* `Удаление учетной записи`_

.. _rst-markup-all:

Получение списка всех доступных учетных записей
-----------------------------------------------

Метод: `GET All`_

Метод вернет список доступных учетных записей авторизованного пользователя. Пользователь определяется по :doc:`Access Token</auth_oidc/index>` из запроса.

Администратор всегда получит данные по всем учетным записям. Если подключен :ref:`многопользовательский режим<rst-markup-mpr>`, то пользователи получат данные только по тем учетным записям, в которые у них есть доступ. 

Для пользователей Компаний-Партнеров и партнеров УЦ учетные записи фильтруются по переданному в запросе :doc:`api-key</auth_oidc/index>`. Таким образом, пользователи получат данные по тем учетным записям, к которым у них есть доступ. 

В ответ на вызов метода можно получить актуальную информацию по каждой учетной записи: 

* сведения о головной организации: ИНН, КПП, наименование;

* список продуктов Контура, к которым пользователь имеет доступ;

* ``role`` — роль пользователя в данной учетной записи: администратор, пользователь, генеральный директор;

* ``name`` — наименование учетной записи;

* ``abonent-Id`` — идентификатор группы учетных записей;

* разрешения для пользователя из запроса:

    * ``has-web-access`` — флаг доступа в веб-интерфейс Контур.Экстерн. Если вернулось значение *true*, то пользователь имеет доступ в веб-интерфейс Контур.Экстерна;
    * ``is-demand-recipient`` — флаг получателя требований. Если вернулось значение *true*, то пользователь может получать требования из ФНС;
    * ``can-add-organizations`` — флаг добавления дочерних организаций. Если вернулось значение *true*, то пользователь может добавлять дочерние организации в учетную запись . 


Создание новой учетной записи
-----------------------------

Метод: `POST Account`_

С помощью данного метода можно создавать новые учетные записи. Организация, данные которой переданы в запросе, будет считаться головной.

Для пользователей сервисов Компаний-Партнеров можно создать учетную запись, если организации этих пользователей еще не зарегистрированы в Контур.Экстерне.


.. _rst-markup-account:

Получение учетной записи по идентификатору
------------------------------------------

Метод: `GET Account`_

Метод вернет сведения об учетной записи по идентификатору ``accountId``. 

.. _rst-markup-users:

Получение списка пользователей учетной записи
---------------------------------------------

Метод: `GET Users`_

Метод вернет всех пользователей для указанной учетной записи. Метод доступен только для администраторов. В ответ метод вернет каждого пользователя столько раз, ко скольким учетным записям он имеет доступ. 

По пользователю метод вернет всю доступную и актуальную информацию:

* ``login`` — логин пользователя;
* ``fio`` — ФИО пользователя;
* ``login-certificates`` — сертификаты для авторизации и их отпечатки.

Удаление учетной записи
-----------------------

Метод: `DELETE Account`_

Метод удаляет указанную учетную запись.

Для пользователей сервисов Компаний-Партнеров можно удалить учетную запись, которую ранее создали самостоятельно.