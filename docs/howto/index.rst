.. _`swagger`: https://developer.kontur.ru/doc/extern
.. _`SDK`: https://github.com/skbkontur/extern-java-sdk/
.. _`Extern Test Tools`: https://developer.kontur.ru/doc/extern.test.tools
.. _`тестовой площадке`: https://extern-api.testkontur.ru

Начало работы с API
===================

.. toctree::
   :maxdepth: 2
   :hidden:
   
   stepbystep
   howtodrafts
   howtodocflow

.. rubric:: Для начала работы с API

* Получите :doc:`/auth_oidc/api-key`.
* Пройдите :doc:`аутентификацию</auth_oidc/index>` и получите Access Token. 
* Для криптографических операций необходимо иметь электронную подпись.

Если вы еще не заключали договор с Контуром и хотите познакомиться с методами API, напишите нам. Мы вышлем вам тестовый api-key, сертификат и тестовую учетную запись. 

Когда вы примете решение об интеграции и заключите договор с Контуром, вам будут высланы данные вашей персональной учетной записи для боевой и тестовой площадки. 

Так как в API много разделов и методов, это может запутать вас при первом погружении в тему электронного документооборота. Ниже описаны главные особенности API, которые нужно учитывать при работе с методами. Чтобы помочь вам постепенно погрузиться в API и использовать только нужные методы, мы описали наиболее частые сценарии по работе с API и составили алгоритм действий для каждого из них. 

.. rubric:: Что нужно знать об API

**Возвращаемые значения** — json, кроме сервиса контентов. Даже если в методе возвращаются байты, то они вернутся в виде Json-строки. Внутри строки контент возвращается в формате base64. Напротив, **принимаемые значения** контентов ожидаются как application/octet-stream. 

**Работа с методами.** Все доступные методы можно смотреть через `swagger`_. Это упрощает создание http клиентов для вашего языка программирования. Если хотите отправлять запросы через Postman, то вы можете скачать JSON файл swagger’a и импортировать его в Postman.

Для Java есть официальный `SDK`_.

Для **генерации тестовых данных** мы разработали сервис `Extern Test Tools`_, который позволяет сгенерировать данные пользователя, а также примеры отчетов в ФНС.

**Тестовая площадка**. На `тестовой площадке`_ есть свой набор инспекций (роботов), к которым стоит обращаться. Они отличаются стратегией обработки документооборотов. При работе с отчетностью в ФНС используйте следующие коды инспекций:

    * 0087 — Принимает все документы.
    * 0088 — Что бы вы ему не прислали — не примет.

.. rubric:: Сценарии работы с API

Порядок работы с методами зависит от цели и задач, которые вы решаете. Выделим основные три направления в работе с API Контур.Экстерна:

- :ref:`отправка отчетности в контролирующие органы<rst-markup-sendalg>`,
- :doc:`мониторинг документооборотов</howto/howtodocflow>`,
- представление ответа на требования ИФНС.

Все перечисленные сценарии описаны в виде алгоритма действий с примерами вызова методов. 
