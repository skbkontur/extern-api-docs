.. _`таблица требований`: https://support.kontur.ru/extern/51603-vozmozhnosti_tablicy_trebovanij
.. _`инструкции`: https://support.kontur.ru/extern/51647-naznachenie_otvetstvennyx_sotrudnikov_v_tablice#header_51647_1 

Таблица требований
==================

В Контур.Экстерн есть `таблица требований`_, с помощью которой можно контролировать статусы и сроки по требования ФНС и СФР за все организации. В API Контур.Экстерна можно взаимодействовать с таблицей требований по основным сценариям:

1. Фильтрация требований по параметрам.
2. Добавление к требованию комментария и меток.
3. Перенос требования из письма. 
4. Назначение ответственных за работу с требованием.

Фильтрация требований по параметрам
-----------------------------------

Метод: :ref:`Поиск документооборотов<rst-markup-get-dcs>`

Список требований можно получись с помощью фильтра ``type`` = fns534-demand.

По фильру ``demandNumber`` можно получить список требований с одним и тем же номером требования.

При необходимости можно получить список требований для определенной организации, для этого укажите в запросе идентификатор нужной организации в параметре ``org``.

В метаинформации ``description`` → ``DemandDescription`` ответа метода для каждого требования вернется дата окончания срока отправки квитанции ``receipt-deadline-date`` и статус квитанции ``receipt-status``.

Добавление к требованию комментария и меток
-------------------------------------------

Метод: :ref:`Изменение реквизитов документа требования<rst-markup-patch_docunent>`

Для каждого требованиям можно добавить, изменить или удалить комментарий и метки. Комментарий может быть один, по меткам нет ограничений.

В теле запроса нужно передать:

* ``value`` — название метки или комментарий;
* ``path`` — путь до параметра;
* ``op`` — операцию, которую нужно сделать:

    * ``add`` — добавить;
    * ``replace`` — заменить;
    * ``remove`` — удалить.

**Пример добавления метки**

.. code-block:: json

    {
    "value": {
      "name": "Label4"
    },
    "path": "/description/requisites/labels/3",
    "op": "add"
  }

**Пример добавления комментария**

.. code-block:: json

    {
    "value": {
      "text": "Комментарий",
      "color": "red"
    },
    "path": "/description/requisites/comment",
    "op": "add"
  }

Перенос требования из письма
----------------------------

Метод: :ref:`Изменение реквизитов документооборота<rst-markup-patch_docflow>`

Требование может поступить в виде входящего письма. В таком случае его можно перенести в требование. Для этого измените КНД поступившего документооборота. 

В теле запроса нужно передать:

* ``value`` — значение КНД, на который нужно заменить КНД поступившего документооборота;
* ``path`` — путь до параметра;
* ``op`` — операцию, которую нужно сделать:

    * ``add`` — добавить;
    * ``replace`` — заменить;
    * ``remove`` — удалить.

**Пример запроса**

.. code-block:: json

    {
    "value": "1160075",
    "path": "/description/requisites/demand-knd",
    "op": "add"
  },

Назначение ответственных за работу с требованием
------------------------------------------------

Метод: :ref:`Изменение реквизитов документа требования<rst-markup-patch_docunent>`

Для конкретного требования можно назначить, изменить или удалить ответственного пользователя. Данный пользователь должен быть зарегистрирован в Контур.Экстерн и иметь доступ к организации. Добавить сотрудника в список возможных ответственных за работу по требованиям можно в веб-интерфейсе Контур.Экстерна по `инструкции`_.

Для одного требования можно добавить одного ответственного. После назначения пользователю будет выслано сообщение на его почту с необходимой информацией и файлом требования.

В теле запроса нужно передать:

* ``value`` — идентификатор пользователя;
* ``path`` — путь до параметра;
* ``op`` — операцию, которую нужно сделать:
    
    * ``add`` — добавить;
    * ``replace`` — заменить;
    * ``remove`` — удалить.

Получить список всех ответственных можно методом :ref:`Получение списка ответственных за работу с требованием<rst-markup-demand-assigness>`.

**Пример назначения ответственного**

.. code-block:: json

    {
    "value": [
      {
        "id": "f39c4f77-6056-46ac-af1a-d2a6f3dd2e5d"
      }
    ],
    "path": "/description/requisites/assignees",
    "op": "add"
  }

**Пример удаления ответственного**

.. code-block:: json

    {
    "path": "/description/requisites/assignees",
    "op": "remove"
  }