.. _`POST BuildDocument`: https://developer.kontur.ru/doc/extern.drafts/method?type=post&path=%2Fv1%2F%7BaccountId%7D%2Fdrafts%2F%7BdraftId%7D%2Fdocuments%2F%7BdocumentId%7D%2Fbuild
.. _`POST BuildDocumentContent`: https://developer.kontur.ru/doc/extern.drafts/method?type=post&path=%2Fv1%2F%7BaccountId%7D%2Fdrafts%2F%7BdraftId%7D%2Fbuild-document


Методы генерации файлов отчетов в черновике
===========================================

Список доступных методов:

* `Создание файла в документе по контракту`_
* `Создание и замена документа по контракту`_

Некоторые формализованные документы для ФНС и ПФР можно создать прямо в черновике, а не загружать уже готовые. По :doc:`контрактам</manuals/contracts>` методы данного раздела формируют документы в черновике. Контракт указывает на тип и формат документа, а также содержит информацию, которая будет передана в ФНС или ПФР. 

**Список форм, которые доступны для формирования:**

* декларации по упрощенной системе налогообложения (УСН);
* запрос на сверку с налоговой (ИОН запрос);
* заявление на подключение к ЭДОК;
* подписка оператора на организацию по РНС для СЭДО ФСС;
* подписка страхователя по РНС;
* подписка страхователя по сотруднику.

Существует пять видов ИОН запросов:

1. Запрос по справке о состоянии расчетов по налогам, сборам, пеням и штрафам (Форма N39-1);
2. Запрос по выписке операций по расчетам с бюджетом;
3. Запрос по перечню налоговых деклараций (расчетов) и бухгалтерской отчетности;
4. Запрос по акту сверки расчетов по налогам, сборам, пеням и штрафам;
5. Запрос справки об исполнении налогоплательщиком (плательщиком сборов, налоговым агентом) обязанности по уплате налогов, сборов, пеней, штрафов.

Согласно :doc:`порядку работы с черновиками</drafts/порядок работы с черновиками>`, методы нужно использовать на шаге наполнения черновика. После создания файла установленного формата в документе черновика нужно добавить подпись к файлу. 

В результате для декларации УСН будет создан документооборот с типом urn:docflow:fns534-report, для ИОН запроса — urn:docflow:fns534-ion, для заявления на подключение к ЭДОК — urn:docflow:pfr-ancillary.

Создание файла в документе по контракту
---------------------------------------

Метод: `POST BuildDocument`_

Данный метод позволяет создать файл установленного формата в указанном документе черновика.  

**Описание параметров метода:**

    * В параметре type необходимо указать тип документа:
        
        * USN — УСН, 
        * ION1 — ИОН1, 
        * ION2 — ИОН2, 
        * ION3 — ИОН3, 
        * ION4 — ИОН4, 
        * ION5 — ИОН5, 
        * ZPED — заявление на подключение к ЭДОК,
        * fssSedoProviderSubscriptionForRegistrationNumber — подписка оператора на организацию по РНС,
        * fssSedoAbonentSubscriptionForRegistrationNumber — подписка страхователя по РНС,
        * fssSedoAbonentSubscriptionForSnils — подписка страхователя по сотруднику.

    * Параметр version означает версию контракта. 
    
        - Для УСН принимает значение 1, 2 и 3. 
        - Для ИОН запросов версия всегда равна 1. 
        - В заявлении на подключение к ЭДОК не используется.
    
**В теле запроса** необходимо передать :doc:`контракт</manuals/contracts>` в формате валидного JSON. 

На основании переданного контракта будет сформирован файл отчета. Если файл успешно создан, его контент появится в документе черновика, и метод вернет пустой ответ 200.

Метод можно использовать после создания черновика и пустого документа в нем. В результате вызова метода в документе появится контент файла установленного формата. 

Создание и замена документа по контракту
----------------------------------------

Метод: `POST BuildDocumentContent`_

С помощью этого метода можно создать документ в черновике, который будет содержать контент файла установленного формата. 

**Описание параметров метода:**

    * В параметре type необходимо указать тип документа:
        
        * USN — УСН, 
        * ION1 — ИОН1, 
        * ION2 — ИОН2, 
        * ION3 — ИОН3, 
        * ION4 — ИОН4, 
        * ION5 — ИОН5, 
        * ZPED — заявление на подключение к ЭДОК,
        * fssSedoProviderSubscriptionForRegistrationNumber — подписка оператора на организацию по РНС,
        * fssSedoAbonentSubscriptionForRegistrationNumber — подписка страхователя по РНС,
        * fssSedoAbonentSubscriptionForSnils — подписка страхователя по сотруднику.

    * Параметр version означает версию контракта. 
    
        - Для УСН принимает значение 1, 2 и 3. 
        - Для ИОН запросов версия всегда равна 1. 
        - В заявлении на подключение к ЭДОК не используется.
    
**В теле запроса** необходимо передать :doc:`контракт</manuals/contracts>` в формате валидного JSON. 

Если файл успешно создан, метод вернет ответ 200 и сформированный в черновике документ.
