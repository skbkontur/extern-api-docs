



<!DOCTYPE html>
<html class="writer-html5" lang="ru" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Печать документов &mdash; документация extern-api 1.1</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a26a8363" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=556afa7a" />
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />

  
    <link rel="shortcut icon" href="../../_static/favicon2.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=38da9577"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/translations.js?v=cd1d70c9"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Алфавитный указатель" href="../../genindex.html" />
    <link rel="search" title="Поиск" href="../../search.html" />
    <link rel="next" title="Таблица отчетности" href="reports_table.html" />
    <link rel="prev" title="Передача черновика в веб-интерфейс Контур.Экстерна" href="general_drafts.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            extern-api
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Поиск в документации" aria-label="Поиск в документации" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Меню навигации">
              <p class="caption" role="heading"><span class="caption-text">История изменений</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../release%20notes.html">История изменений API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Подготовка</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../models_of_cooperation.html">Модели сотрудничества</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../capabilites_api.html">Возможности API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howto/index.html">Начало работы с API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../recommendations.html">Рекомендации по работе c API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auth_oidc/index.html">Аутентификация OpenID Connect</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Работа с API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Сценарии</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Устройство и особенности API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="content.html">Сервис контентов</a></li>
<li class="toctree-l3"><a class="reference internal" href="DraftsBuilder.html">DraftsBuilder</a></li>
<li class="toctree-l3"><a class="reference internal" href="loks.html">Блокировки</a></li>
<li class="toctree-l3"><a class="reference internal" href="general_drafts.html">Передача черновика в веб-интерфейс Контур.Экстерна</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Печать документов</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">Особенности методов печати</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rst-markup-print-async">Асинхронный вызов методов</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">Печать документа в черновике</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">Печать документа в документообороте</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reports_table.html">Таблица отчетности</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../org/index.html">Организации и учетные записи</a></li>
<li class="toctree-l2"><a class="reference internal" href="../FNS/index.html">ФНС</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Rosstat/index.html">Росстат</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SFR/index.html">СФР</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../drafts/work-order-drafts.html">Порядок работы с черновиками</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dc/work-order-do.html">Порядок работы с документооборотами</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../specification/index.html">Спецификация</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../test/index.html">Тестовые данные</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Методы API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../accounts/index.html">Работа с учетными записями</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../drafts/index.html">Работа с черновиками</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dc/index.html">Работа с документооборотами</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../inventories/index.html">Представление документов к требованиям</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../builder/index.html">Конструктор черновиков (DraftsBuilder)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contents/index.html">Сервис контентов</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Дополнительно</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../manuals/index.html">Справка</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../SDK.html">SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contacts.html">Контакты</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Меню навигации для мобильных устройств" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">extern-api</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Навигация по страницам">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Сценарии</a></li>
          <li class="breadcrumb-item"><a href="index.html">Устройство и особенности API</a></li>
      <li class="breadcrumb-item active">Печать документов</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/scenarios/device_api/print.rst.txt" rel="nofollow"> Просмотреть исходный код страницы</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1>Печать документов<a class="headerlink" href="#id1" title="Ссылка на этот заголовок"></a></h1>
<p>В API Контур.Экстерна реализована печать документов в черновиках и документооборотах.</p>
<ul class="simple">
<li><p>для печати документа в черновике используйте метод <a class="reference internal" href="../../drafts/DraftDocumentsController.html#rst-markup-draft-print"><span class="std std-ref">GET DraftDocumentPrint</span></a>.</p></li>
<li><p>для печати документа в документообороте используйте метод <a class="reference internal" href="../../dc/%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D1%8B%20API%20%D0%B4%D0%BB%D1%8F%20%D0%94%D0%9E.html#rst-markup-dcprint"><span class="std std-ref">POST DocflowDocumentPrint</span></a>.</p></li>
<li><p>для печати документа в документообороте описи используйте метод <a class="reference internal" href="../../inventories/%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D1%8B%20%D0%B4%D0%BE%20%D0%BE%D0%BF%D0%B8%D1%81%D0%B8.html#rst-markup-inventory-print"><span class="std std-ref">POST DocumentPrint</span></a>.</p></li>
</ul>
<section id="id2">
<h2>Особенности методов печати<a class="headerlink" href="#id2" title="Ссылка на этот заголовок"></a></h2>
<ol class="arabic">
<li><p>Методы печати подготавливают печатную форму документа в формате pdf файла.</p></li>
<li><p>Методы работают только с расшифрованными контентами.</p></li>
<li><p>Методы поддерживают не все типы документов и контентов. Если печать невозможна, методы вернут ошибку 400 documentPrintUnsupported.</p></li>
<li><p>Методы печати умеют работать только со следующими типами контента:</p>
<blockquote>
<div><ul class="simple">
<li><p>«application/octet-stream»,</p></li>
<li><p>«application/xml»,</p></li>
<li><p>«text/xml».</p></li>
</ul>
</div></blockquote>
</li>
</ol>
</section>
<section id="rst-markup-print-async">
<span id="id3"></span><h2>Асинхронный вызов методов<a class="headerlink" href="#rst-markup-print-async" title="Ссылка на этот заголовок"></a></h2>
<p>Методы печати необходимо выполнять <a class="reference internal" href="../../recommendations.html#rst-markup-deferred"><span class="std std-ref">асинхронно</span></a>. Для этого в параметрах запроса передайте флаг <code class="docutils literal notranslate"><span class="pre">deferred</span></code> = <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Предупреждение</p>
<p>Значение флага <code class="docutils literal notranslate"><span class="pre">false</span></code> для синхронного вызова метода устарело и больше не используется в методах API. При таком значении вернется ошибка 400 BadRequest.</p>
</div>
<p>Асинхронный вызов запроса создает задачу на печать. В ответе метода вернется идентификатор TaskId поставленной задачи. Для получения печатной формы нужно проверить статус выполнения задачи. Когда статус задачи будет равен <strong>succeed</strong>, печатная форма будет загружена в сервис контентов. В поле <code class="docutils literal notranslate"><span class="pre">task-result</span></code> будет лежать идентификатор контента <code class="docutils literal notranslate"><span class="pre">content-id</span></code>.</p>
</section>
<section id="id4">
<h2>Печать документа в черновике<a class="headerlink" href="#id4" title="Ссылка на этот заголовок"></a></h2>
<p>Методу печати в черновике в запросе нужно передать только идентификатор документа, так как все расшифрованные контенты были предварительно загружены в черновик.</p>
<section id="id5">
<h3>Алгоритм печати документа в черновике<a class="headerlink" href="#id5" title="Ссылка на этот заголовок"></a></h3>
<ol class="arabic simple">
<li><p>Вызвать метод печати <a class="reference internal" href="../../drafts/DraftDocumentsController.html#rst-markup-draft-print"><span class="std std-ref">GET DraftDocumentPrint</span></a> с флагом deferred = true. В случае успеха метод вернет идентификатор TaskId поставленной на печать задачи.</p></li>
<li><p>Получить задачу <a class="reference internal" href="../../drafts/DraftDocumentsController.html#rst-markup-draftdocumenttask"><span class="std std-ref">GET DraftDocumentTask</span></a> по TaskId. Когда статус будет равен значению succeed, в поле task-result будет лежать идентификатор контента content-id.</p></li>
<li><p>Получить сформированную печатную форму документа <a class="reference internal" href="../../contents/content_methods.html#rst-markup-get-content"><span class="std std-ref">GET Download</span></a> по content-id.</p></li>
</ol>
</section>
</section>
<section id="id6">
<h2>Печать документа в документообороте<a class="headerlink" href="#id6" title="Ссылка на этот заголовок"></a></h2>
<p><strong>Как передать расшифрованный контент документа</strong></p>
<blockquote>
<div><p>Для метода печати в документообороте <a class="reference internal" href="../../dc/%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D1%8B%20API%20%D0%B4%D0%BB%D1%8F%20%D0%94%D0%9E.html#rst-markup-dcprint"><span class="std std-ref">DocflowDocument Print</span></a> в теле запроса необходимо передать идентификатор расшифрованного контента документа из <a class="reference internal" href="content.html"><span class="doc">сервиса контентов</span></a>.</p>
<p><em>Если документ зашифрован</em>, у документа в модели docflow-document-contents свойство encrypted равно true, то необходимо предварительно скачать и дешифровать документ. Если контент сжат — признак compressed = true, извлекать контент из архива не обязательно, метод умеет извлекать контент из архива. Далее нужно загрузить контент в сервис контентов. Полученный идентификатор передать в теле метода печати.</p>
<p><em>Если документ уже расшифрован</em>, у документа признак encrypted равен false — скачивать ничего не нужно,  в теле запроса передать идентификатор контента content-id. Идентификатор контента можно посмотреть в информации о документе, в параметре content.</p>
</div></blockquote>
<p><strong>Можно ли заранее узнать возможность печати?</strong></p>
<p>В свойствах документа есть вспомогательный параметр <code class="docutils literal notranslate"><span class="pre">SupportPrint</span></code> (модель DocflowDocumentDescription). Это поле подсказывает, возможна ли печать документа. Оно может принимать значения: Yes, No, Unknown.</p>
<ul class="simple">
<li><p>Если значение <code class="docutils literal notranslate"><span class="pre">SupportPrint</span> <span class="pre">=</span> <span class="pre">yes</span></code>, можно вызывать метод печати, и он вернет печатную форму документа.</p></li>
<li><p>Если значение <code class="docutils literal notranslate"><span class="pre">SupportPrint</span> <span class="pre">=</span> <span class="pre">no</span></code>, печать документа не поддерживается.</p></li>
<li><p>Если значение <code class="docutils literal notranslate"><span class="pre">SupportPrint</span> <span class="pre">=</span> <span class="pre">unknown</span></code>, не получилось определить возможность печати документа, можно попробовать вызвать метод печати.</p></li>
</ul>
<p><strong>Проверка подписи в документообороте</strong></p>
<p>Во время печати метод проверяет переданный на печать расшифрованный и разжатый документ на соответствие подписи этого документа в документообороте. Если на печать передали контент измененного документа, то вернется ошибка.</p>
<section id="rst-markup-process-print">
<span id="id7"></span><h3>Алгоритм печати документа в документообороте<a class="headerlink" href="#rst-markup-process-print" title="Ссылка на этот заголовок"></a></h3>
<p>Для удобства тестирования печати можно скачать файл коллекции Postman:</p>
<p><a class="reference download internal" download="" href="../../_downloads/02b9984940e36a0242bc0cf9c2c946e7/%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D1%8C.postman_collection.json"><code class="xref download docutils literal notranslate"><span class="pre">файл</span> <span class="pre">коллекции</span> <span class="pre">Postman</span></code></a></p>
<ol class="arabic simple">
<li><p>Получить документ в документообороте методом <a class="reference internal" href="../../dc/%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D1%8B%20API%20%D0%B4%D0%BB%D1%8F%20%D0%94%D0%9E.html#rst-markup-get-dc-document"><span class="std std-ref">GET DocflowDocument</span></a>. В ответе важно посмотреть, что лежит в параметре docflow-document-contents: идентификатор content-id, по которому можно получить контент в сервисе контентов, флаги compressed и encrypted. В примере ниже контент документа зашифрован и сжат, флаги равны true.</p></li>
</ol>
<p><strong>Запрос</strong></p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="nf">GET</span> <span class="nn">/v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9/documents/75d929b9-08a9-4692-961d-111cc87dc2e8</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</pre></div>
</div>
<div class="toggle docutils container">
<div class="header docutils container">
<p><strong>Ответ GET DocflowDocument:</strong></p>
</div>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
<span class="na">Content-Encoding</span><span class="o">:</span> <span class="l">gzip</span>

<span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;75d929b9-08a9-4692-961d-111cc87dc2e8&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;urn:document:fns534-report&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;filename&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NO_SRCHIS_0007_0007_7757424860680345565_20200129_92425a70-4ac9-4680-bada-3666f0c0514n.xml&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;content-type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;application/xml&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;encrypted-content-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2237</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;compressed&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;requisites&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span>
<span class="w">        </span><span class="nt">&quot;related-docflows-count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;support-recognition&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;encrypted-certificates&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;serial-number&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;01D0850043AB3C924A605B8D8661E43E&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;serial-number&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;33AC7500C3AAAE924839AA8AE6C459FE&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;serial-number&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;19CCC7C800010000215D&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;support-print&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;yes&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;encrypted&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;rel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;encrypted-content&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://extern-api.testkontur.ru/v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9/documents/75d929b9-08a9-4692-961d-111cc87dc2e8/encrypted-content&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;docflow-document-contents&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;content-id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;f1facbc3-5d74-498f-a8af-dbfd57f82f1f&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;encrypted&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;compressed&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;send-date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2020-02-26T06:51:08.4636938Z&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;signatures&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;82d5457d-5297-49fb-949a-f9865a1491b1&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ООО &#39;Баланс Плюс&#39; (Марков Георгий Эльдарович)&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;signature-certificate-thumbprint&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;20AACA440F33D0C90FBC052108012D3062D44873&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;content-link&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;rel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;content&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://extern-api.testkontur.ru/v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9/documents/75d929b9-08a9-4692-961d-111cc87dc2e8/signatures/82d5457d-5297-49fb-949a-f9865a1491b1/content&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;links&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;rel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;self&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://extern-api.testkontur.ru/v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9/documents/75d929b9-08a9-4692-961d-111cc87dc2e8/signatures/82d5457d-5297-49fb-949a-f9865a1491b1/content&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;rel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;docflow&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://extern-api.testkontur.ru/v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;045d9beb-7748-4789-a539-4416fa7969b9&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ООО &#39;Баланс Плюс&#39; (Марков Георгий Эльдарович)&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;signature-certificate-thumbprint&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;20AACA440F33D0C90FBC052108012D3062D44873&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;content-link&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;rel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;content&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://extern-api.testkontur.ru/v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9/documents/75d929b9-08a9-4692-961d-111cc87dc2e8/signatures/045d9beb-7748-4789-a539-4416fa7969b9/content&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;links&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;rel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;self&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://extern-api.testkontur.ru/v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9/documents/75d929b9-08a9-4692-961d-111cc87dc2e8/signatures/045d9beb-7748-4789-a539-4416fa7969b9/content&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;rel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;docflow&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://extern-api.testkontur.ru/v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;565164bb-c9d5-4805-8250-7f6a4ac9d4aa&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Корионов  Илья Валерьянович&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;signature-certificate-thumbprint&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;344AAD7111FC77ADE2A98FFB5E35F039BC4DD650&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;content-link&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;rel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;content&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://extern-api.testkontur.ru/v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9/documents/75d929b9-08a9-4692-961d-111cc87dc2e8/signatures/565164bb-c9d5-4805-8250-7f6a4ac9d4aa/content&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;links&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;rel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;self&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://extern-api.testkontur.ru/v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9/documents/75d929b9-08a9-4692-961d-111cc87dc2e8/signatures/565164bb-c9d5-4805-8250-7f6a4ac9d4aa/content&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;rel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;docflow&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://extern-api.testkontur.ru/v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;links&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;rel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;docflow&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://extern-api.testkontur.ru/v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;rel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;self&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://extern-api.testkontur.ru/v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9/documents/75d929b9-08a9-4692-961d-111cc87dc2e8&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;rel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;related-docflow&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://extern-api.testkontur.ru//v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9/documents/75d929b9-08a9-4692-961d-111cc87dc2e8/related&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;rel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;encrypted-content&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://extern-api.testkontur.ru/v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9/documents/75d929b9-08a9-4692-961d-111cc87dc2e8/encrypted-content&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;rel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;decrypt-content&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;href&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://extern-api.testkontur.ru/v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9/documents/75d929b9-08a9-4692-961d-111cc87dc2e8/decrypt-content&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<ol class="arabic simple" start="2">
<li><p>Скачать контент из сервиса контентов <a class="reference internal" href="../../contents/content_methods.html#rst-markup-get-content"><span class="std std-ref">GET Download</span></a> по content-id.</p></li>
<li><p>Расшифровывать полученный документ и загрузить его обратно в сервис контентов <a class="reference internal" href="../../contents/content_methods.html#rst-markup-post-content"><span class="std std-ref">POST Upload</span></a>. В ответе метод вернет новый идентификатор content-id2.</p></li>
<li><p>Вызвать метод печати <a class="reference internal" href="../../dc/%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D1%8B%20API%20%D0%B4%D0%BB%D1%8F%20%D0%94%D0%9E.html#rst-markup-dcprint"><span class="std std-ref">POST DocflowDocumentPrint</span></a> с флагом deferred = true. В теле метода передать content-id2. В ответе вернется идентификатор поставленной на печать задачи TaskId.</p></li>
</ol>
<p><strong>Запрос</strong></p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="nf">POST</span> <span class="nn">/v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9/documents/75d929b9-08a9-4692-961d-111cc87dc2e8/print?deferred=true</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="o">:</span> <span class="l">Bearer &lt;token&gt;</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>

<span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;content-id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;d065adea-8b9d-4228-bc17-8f86539e01a3&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Ответ</strong></p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">126</span>

<span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;819ade20-665c-470a-befc-e897a56e1641&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;task-state&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;running&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;task-type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;urn:task-type:docflowPrint&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<ol class="arabic" start="5">
<li><p>Получить по TaskId результат выполнения задачи на печать в методе <a class="reference internal" href="../../dc/%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D1%8B%20API%20%D0%B4%D0%BB%D1%8F%20%D0%94%D0%9E.html#rst-markup-docflowdocumenttask"><span class="std std-ref">GET DocflowDocumentTask</span></a>. Запрашивать задачу нужно до тех пор, пока task-state = running. Когда задача завершится со статусом succeed, в поле «task-result» будет лежать новый идентификатор content-id3.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Примечание</p>
<p>Чем больше документ, тем больше времени необходимо сервису для печати, рекомендуемый интервал между повторными запросами — 5 секунд.</p>
</div>
</div></blockquote>
</li>
</ol>
<p><strong>Запрос</strong></p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="nf">GET</span> <span class="nn">/v1/bd0cd3f6-315d-4f03-a9cc-3507f63265ed/docflows/a9bc74bd-311b-43f0-aff7-faba24ce35d9/documents/75d929b9-08a9-4692-961d-111cc87dc2e8/tasks/819ade20-665c-470a-befc-e897a56e1641</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="o">:</span> <span class="l">Bearer &lt;token&gt;</span>
</pre></div>
</div>
<p><strong>Ответ</strong></p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">210</span>

<span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;819ade20-665c-470a-befc-e897a56e1641&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;task-state&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;succeed&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;task-type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;urn:task-type:docflowPrint&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;task-result&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;content-id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;9f6b57db-db9f-4e4c-8375-62a3504e663d&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Получить документ из сервиса контентов по content-id3. Будет загружен готовый pdf файл.</p></li>
</ol>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Нижняя область">
        <a href="general_drafts.html" class="btn btn-neutral float-left" title="Передача черновика в веб-интерфейс Контур.Экстерна" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Предыдущая</a>
        <a href="reports_table.html" class="btn btn-neutral float-right" title="Таблица отчетности" accesskey="n" rel="next">Следующая <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
 	document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('.toggle').forEach(item => {
        const switcher = document.createElement('div');
        switcher.classList.add('switcher');
        switcher.addEventListener('click', () => {
          item.classList.toggle('open');
        })
        item.appendChild(switcher);
      });
    })
    /*
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
    */
</script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
  m[i].l=1*new Date();
  for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
  k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
  (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

  ym(92390594, "init", {
       clickmap:true,
       trackLinks:true,
       accurateTrackBounce:true,
       webvisor:true
  });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/92390594" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->



</body>
</html>